<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Mapa de Praias de Portugal</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; font-family: Arial; }
    #map { height: 100vh; }
    .popup-content { font-size: 14px; }
    .dados-box { padding: 10px; background: #eef; margin-top: 10px; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="dados" class="dados-box"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const praias = [
      { nome: "Peniche", lat: 39.3558, lng: -9.3811 },
      { nome: "Carcavelos", lat: 38.6766, lng: -9.3250 },
      { nome: "Cruz Quebrada", lat: 38.7012, lng: -9.2425 },
      { nome: "São João da Caparica", lat: 38.6333, lng: -9.2333 },
      { nome: "Guincho", lat: 38.7286, lng: -9.4722 },
      { nome: "Praia da Rocha", lat: 37.1019, lng: -8.6741 },
      { nome: "Figueira da Foz", lat: 40.1500, lng: -8.8667 },
      { nome: "Moledo", lat: 41.8000, lng: -8.8667 }
    ];

    const map = L.map('map').setView([39.5, -8.5], 7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    praias.forEach(praia => {
      const marker = L.marker([praia.lat, praia.lng]).addTo(map);
      marker.bindPopup(`
        <div class="popup-content">
          <strong>${praia.nome}</strong><br>
          <button onclick="verDados(${praia.lat}, ${praia.lng}, '${praia.nome}')">Ver Dados</button>
        </div>
      `);
    });

    async function verDados(lat, lng, nome) {
      const params = 'waveHeight,airTemperature,waterTemperature,windSpeed';
      const apiKey = 'TUA_API_KEY_AQUI'; // Substitui pela tua chave Stormglass
      const url = `https://api.stormglass.io/v2/weather/point?lat=${lat}&lng=${lng}&params=${params}`;

      try {
        const response = await fetch(url, {
          headers: { Authorization: apiKey }
        });
        const data = await response.json();
        const info = data.hours[0];
        const hora = new Date(info.time).toLocaleString();

        document.getElementById('dados').innerHTML = `
          <h3>🌊 Dados Marítimos - ${nome}</h3>
          <strong>📅 Hora:</strong> ${hora}<br>
          🌊 <strong>Altura das ondas:</strong> ${info.waveHeight?.noaa ?? 'N/D'} m<br>
          💨 <strong>Vento:</strong> ${info.windSpeed?.noaa ?? 'N/D'} m/s<br>
          🌡️ <strong>Temperatura do ar:</strong> ${info.airTemperature?.noaa ?? 'N/D'} °C<br>
          🌊 <strong>Temperatura da água:</strong> ${info.waterTemperature?.noaa ?? 'N/D'} °C
        `;
      } catch (err) {
        document.getElementById('dados').innerText = 'Erro ao obter dados.';
        console.error(err);
      }
    }
  </script>
</body>
</html>
