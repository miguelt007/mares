<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Mapa de Praias com Filtros</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; font-family: Arial; }
    #map { height: 100vh; }
    #filtros {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1000;
      background: rgba(255,255,255,0.95);
      padding: 10px;
      border-radius: 8px;
    }
    #filtros select {
      margin: 4px;
      padding: 6px;
    }
  </style>
</head>
<body>
  <div id="filtros">
    <select id="regiaoSelect">
      <option value="Todas">Todas as regiões</option>
      <option value="Norte">Norte</option>
      <option value="Centro">Centro</option>
      <option value="Lisboa e Vale do Tejo">Lisboa e Vale do Tejo</option>
      <option value="Alentejo">Alentejo</option>
      <option value="Algarve">Algarve</option>
      <option value="Madeira">Madeira</option>
      <option value="Açores">Açores</option>
    </select>
    <select id="tipoSelect">
      <option value="Todos">Todos os tipos</option>
      <option value="Surf">Surf</option>
      <option value="Urbana">Urbana</option>
      <option value="Familiar">Familiar</option>
      <option value="Naturista">Naturista</option>
      <option value="Turística">Turística</option>
      <option value="Isolada">Isolada</option>
    </select>
    <select id="bandeiraSelect">
      <option value="Todas">Todas</option>
      <option value="true">Bandeira Azul</option>
      <option value="false">Sem Bandeira Azul</option>
    </select>
    <button onclick="filtrarPraias()">Filtrar</button>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([39.5, -8], 7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    const icons = {
      Surf: L.icon({ iconUrl: 'https://cdn-icons-png.flaticon.com/512/861/861512.png', iconSize: [30, 30], iconAnchor: [15, 30] }),
      Urbana: L.icon({ iconUrl: 'https://cdn-icons-png.flaticon.com/512/235/235861.png', iconSize: [30, 30], iconAnchor: [15, 30] }),
      Familiar: L.icon({ iconUrl: 'https://cdn-icons-png.flaticon.com/512/3062/3062634.png', iconSize: [30, 30], iconAnchor: [15, 30] }),
      Naturista: L.icon({ iconUrl: 'https://cdn-icons-png.flaticon.com/512/168/168882.png', iconSize: [30, 30], iconAnchor: [15, 30] }),
      Turística: L.icon({ iconUrl: 'https://cdn-icons-png.flaticon.com/512/854/854894.png', iconSize: [30, 30], iconAnchor: [15, 30] }),
      Isolada: L.icon({ iconUrl: 'https://cdn-icons-png.flaticon.com/512/684/684908.png', iconSize: [30, 30], iconAnchor: [15, 30] })
    };

    const praias = [
      {
        nome: "Praia da Nazaré",
        municipio: "Nazaré",
        regiao: "Centro",
        tipo: "Surf",
        bandeiraAzul: true,
        latitude: 39.602,
        longitude: -9.070
      },
      {
        nome: "Praia do Guincho",
        municipio: "Cascais",
        regiao: "Lisboa e Vale do Tejo",
        tipo: "Naturista",
        bandeiraAzul: false,
        latitude: 38.732,
        longitude: -9.472
      },
      {
        nome: "Praia da Rocha",
        municipio: "Portimão",
        regiao: "Algarve",
        tipo: "Turística",
        bandeiraAzul: true,
        latitude: 37.118,
        longitude: -8.538
      },
      {
        nome: "Praia de São Pedro de Moel",
        municipio: "Marinha Grande",
        regiao: "Centro",
        tipo: "Familiar",
        bandeiraAzul: true,
        latitude: 39.767,
        longitude: -9.026
      },
      {
        nome: "Praia do Porto Santo",
        municipio: "Porto Santo",
        regiao: "Madeira",
        tipo: "Isolada",
        bandeiraAzul: true,
        latitude: 33.059,
        longitude: -16.333
      }
    ];

    const marcadores = [];

    function mostrarPraias(lista) {
      marcadores.forEach(m => map.removeLayer(m));
      marcadores.length = 0;

      lista.forEach(praia => {
        const icon = icons[praia.tipo] || icons.Urbana;
        const marker = L.marker([praia.latitude, praia.longitude], { icon }).addTo(map);
        marker.bindPopup(`<strong>${praia.nome}</strong><br>${praia.municipio}, ${praia.regiao}<br>Tipo: ${praia.tipo}<br>Bandeira Azul: ${praia.bandeiraAzul ? '✅' : '❌'}`);
        marcadores.push(marker);
      });
    }

    function filtrarPraias() {
      const regiao = document.getElementById('regiaoSelect').value;
      const tipo = document.getElementById('tipoSelect').value;
      const bandeira = document.getElementById('bandeiraSelect').value;

      const filtradas = praias.filter(p => {
        const r = regiao === 'Todas' || p.regiao === regiao;
        const t = tipo === 'Todos' || p.tipo === tipo;
        const b = bandeira === 'Todas' ||
                  (bandeira === 'true' && p.bandeiraAzul === true) ||
                  (bandeira === 'false' && p.bandeiraAzul === false);
        return r && t && b;
      });

      mostrarPraias(filtradas);
    }

    mostrarPraias(praias);
  </script>
</body>
</html>
